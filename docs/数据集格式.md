# ShareGPT格式

最内层是键为**“from”**、**“value“**，值为**角色**、**发言**的字典；例如

```
{
	"from": "human",
	"value": "你好"
}
```

其外层是由若干这种字典构成的列表，一个这种列表代表一段完整的对话；例如

```
[
	{
		"from": "human",
    	"value": "你好"
  	},
  	{
    	"from": "gpt",
    	"value": "你好！"
  	},
  	{
    	"from": "human",
    	"value": "你叫什么名字"
  	},
  	{
    	"from": "gpt",
    	"value": "我叫chat-gpt"
  	}
]
```

再外层是一个上述列表做值，**“conversations”**做键的一个字典，作为一个独立样本

```
{
	"conversations": [
		{
    		"from": "human",
    		"value": "你好"
  		},
  		{
    		"from": "gpt",
    		"value": "你好！"
  		},
  		{
    		"from": "human",
    		"value": "你叫什么名字"
  		},
  		{
    		"from": "gpt",
    		"value": "我叫chat-gpt"
  		}
  	]
}
```

一个数据集由若干这种独立样本构成，一般采用存储在**json**、**jsonl**、**parquet**格式的文件中。
对于**jsonl**格式文件，每行存储一个上述类型的字典，如

```
{"conversations": [{"from": "human", "value": "你好"}, {"from": "gpt", "value": "你好！"}]}
{"conversations": [{"from": "human", "value": "你叫什么名字"}, {"from": "gpt", "value": "我叫chat-gpt"}]}
{"conversations": [{"from": "human", "value": "中国首都是哪？"}, {"from": "gpt", "value": "中国首都是北京"}]}
```

对于**json**格式文件，其存储一个json列表，其中包含若干上述类型的字典，如
```
[
  	{
    	"conversations": [
      		{
        		"from": "human",
        		"value": "你好"
      		},
      		{
        		"from": "gpt",
        		"value": "你好！"
      		}
    	]
  	},
  	{
    	"conversations": [
      		{
        		"from": "human",
        		"value": "中国首都是哪？"
      		},
      		{
        		"from": "gpt",
        		"value": "中国首都是北京"
      		}
    	]
  	}
]
```

需要注意的是**ShareGPT**格式本身是非严格的，这意味着以下一些事情：

* 键名**from**、**value**可以被替换成**role**、**content**
* 若使用**from**、**value**键名，则**from**的值**通常**为**system**、**human**、**gpt**
* 若使用**role**、**content**键名，则**role**的值**通常**为**system**、**user**、**assistant**
* 除去**conversations**外还可能存在其他键，例如**title**、**model**、**version**等

采用不同的键值名称在本质上是等价的，在实际数据集中可能存在混用。

***

# ChatML格式（Chat Markup Language)

这是一种更严格的模式，用一个字符串代表一个样本，例如
```
<|im_start|>system
你是一个日常聊天模型。<|im_end|>
<|im_start|>user
你好<|im_end|>
<|im_start|>assistant
你好！<|im_end|>
```

其使用**<|im_start|>**和**<|im_end|>**作为分隔符，由若干片段**直接拼接**而来，每个片段的格式为：

`<|im_start|>`+*角色*+`\n`+*发言*+`<|im_end|>`+`\n`

**需要特别指出的是在实际文件中存储的格式和ShareGPT非常类似，而并非严格的ChatML格式**

这是说实际文件中存储的ChatML格式的数据往往形如

```
{"messages": [{"role": "user", "content": "你好"}, {"role": "assistant", "content": "你好！"}]}
{"messages": [{"role": "user", "content": "你叫什么名字"}, {"role": "assistant", "content": "我叫chat-gpt"}]}
{"messages": [{"role": "user", "content": "中国首都是哪？"}, {"role": "assistant", "content": "中国首都是北京"}]}
```

或者

```
[
  	{
    	"messages": [
      		{
        		"role": "user",
        		"content": "你好"
      		},
      		{
        		"role": "assistant",
        		"content": "你好！"
      		}
    	]
  	},
  	{
    	"messages": [
      		{
        		"role": "user",
        		"content": "中国首都是哪？"
      		},
      		{
        		"role": "assistant",
        		"content": "中国首都是北京"
      		}
    	]
  	}
]
```

**正因如此在实际处理中需要将其转换为标准的ChatML格式，这往往使用框架的chat_template转换接口进行**

***

